input â† â€¢file.Lines "input"

scores â† âŸ¨')'â€¿3, ']'â€¿57, '}'â€¿1197, '>'â€¿25137âŸ©
matchingBrackets â† âŸ¨"()", "[]", "{}", "<>"âŸ©
revMB â† âŒ½Â¨matchingBrackets

FGetDict â† âŠ‘âŠ‘Â¨âˆ˜=/âŠ£

# usage
#scores FGetDict ']'
#scores FGetDict '>'
#revMB FGetDict '>'

# part 1
FOneLine â† {
  stack â† âŸ¨âŸ©
  ret â† {âŠ‘ğ•©âˆŠ"[({<" ? stackâ†©ğ•©âˆ¾stackâ‹„@ 
    ; (1âŠ‘ (revMB FGetDict ğ•©))â‰¡âŠ‘stack ? stackâ†©1â†“stackâ‹„@ ; 
    ğ•©}Â¨ğ•©
  @ (â‰ /âŠ¢) ret
}

illegals â† FOneLineÂ¨ input
justFirstOnes â† (1â†‘Â¨0âŠ¸<âˆ˜â‰ Â¨/âŠ¢) illegals

+Â´1âŠ‘Â¨{scores FGetDict âŠ‘ğ•©}Â¨justFirstOnes

# part 2
incompleteLines â† ((0âŠ¸=âˆ˜â‰ Â¨) illegals)/input
inCount â† â‰ incompleteLines

FOneLine2 â† {
  stack â† âŸ¨âŸ©
  {âŠ‘ğ•©âˆŠ"[({<" ? stackâ†©ğ•©âˆ¾stack
    ; (1âŠ‘ (revMB FGetDict ğ•©))â‰¡âŠ‘stack ? stackâ†©1â†“stack}Â¨ğ•©
  stack
}

# use the opening brackets as scores
revScores â† âŸ¨'('â€¿1, '['â€¿2, '{'â€¿3, '<'â€¿4âŸ©
openMatches â† FOneLine2Â¨ incompleteLines

# can refactor to using FOLD
FCountScore â† {
  totalScore â† 0
  { 
    newScore â† 5 Ã— totalScore â‹„
    addScore â† 1âŠ‘revScores FGetDict ğ•© â‹„
    totalScore â†© newScore + addScore
  }Â¨ğ•©
  totalScore
}

(2Ã·Ëœ1-ËœinCount)âŠ‘âˆ§FCountScoreÂ¨ openMatches




