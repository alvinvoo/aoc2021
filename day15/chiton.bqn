
input â‡ â€¢file.Lines "inputTest"

inputâ†©>{ğ•©-'0'}Â¨input

# find adjacent list (up, down, left, right) with coordinates

FindAdjN â† {
  yâ€¿xâ†ğ•©
  sizeâ†ğ•¨
  pâ†âŸ¨(y+1)â€¿x,yâ€¿(x+1),(y-1)â€¿x,yâ€¿(x-1)âŸ©
  câ†{yâ€¿xâ†ğ•©â‹„(yâ‰¥0)âˆ§(xâ‰¥0)âˆ§(y<size)âˆ§(x<size)}Â¨p
  c/p
}

While â† {ğ•©{ğ”½âŸğ”¾âˆ˜ğ”½_ğ•£_ğ”¾âˆ˜ğ”½âŸğ”¾ğ•©}ğ•¨@}Â´
FSortDistList â† (â‹1âŠ¸âŠË˜âˆ˜>)âŠ¸âŠ

Dijkstra â† {
  start â† ğ•¨
  end â† ğ•©
  size â† â‰ input
  keys â† â¥Šâ†•sizeâ€¿size

  # Priority node queue
  arr â† âˆâ¥ŠËœâ‰ keys
  i â† keys âŠ‘âˆ˜âŠ<start 
  # replace the `start` value with 0
  # TODO: pQ probably dont need all the âˆ inits
  #â€¢Show pQ â† keys<âŠ¸âˆ¾Â¨0âŒ¾(iâŠ¸âŠ‘) arr

  pQ â† âŸ¨startâ‹ˆ0âŸ©

  # Distance list
  distList â‡ 0âŒ¾(iâŠ¸âŠ‘)arr
  done â† 0

  # Previous list
  #prevList â‡ 0â¥ŠËœâ‰ keys # simply, @ cannot be used 

  While {ğ•¤â‹„(doneâ‰ 1) âˆ§ (0<â‰ pQ)}â€¿{ğ•¤
    # sort, get smallest value and drop + reassign
    pQ â†© FSortDistList pQ
    smallestNodeâ†âŠ‘âŠ‘pQ
    pQ â†© 1â†“pQ

    {
      smallestNodeâ‰¡end ? doneâ†©1 ; 
      #find all neighboring nodes of this `smallest`
      
      nbNodesâ†size FindAdjN smallestNode
      smDistâ†âŠ‘(keysâŠ<smallestNode)âŠdistList
      candidateDistâ†smDist+nbNodesâŠ‘input

      nbIndâ†keysâŠnbNodes
      sCâ†candidateDist<nbIndâŠ¸âŠdistList
      nCIndâ†sC/nbInd
      candidateDist /Ëœâ†©sC

      distListâ†©candidateDistâŒ¾(nCIndâŠ¸âŠ)distList
      #prevListâ†©((â‰ nCInd)â¥Š<smallestNode)âŒ¾(nCIndâŠ¸âŠ)prevList

      pQ âˆ¾â†© (nCIndâŠkeys)<âŠ¸âˆ¾Â¨candidateDist
    }
  }

  #cost â‡ âŠ‘(end<âŠ¸(â‰¡Â¨)keys)/distList
  # make it easier for this qns
  â€¢Show distList
  cost â‡ Â¯1âŠ‘distList
  
  #path â‡ âŸ¨endâŸ© {
  #  ğ•©â‰¢0 ? nâ†âŠ‘(ğ•©<âŠ¸(â‰¡Â¨)keys)/prevList â‹„ (n<âŠ¸âˆ¾ğ•¨)ğ•Šn ; 1â†“ğ•¨
  #} end
}

# part 1
d â† 0â€¿0 Dijkstra 9â€¿9

# 10 secs - 447
â€¢Show d.cost

# part 2
# doesnt work; run forever
#incrdMap â† +âŒœËœâ†•5
#â€¢Show â‰¢p2Inputâ†(9âŠ¸<â—¶âŠ¢â€¿(-âŸœ9))Â¨ âˆ¾inputâŠ¸+Â¨incrdMap

# revert to original array
FindAdjN2 â† {
  yâ€¿xâ†ğ•©
  sizeâ†10
  limitâ†ğ•¨
  
  deltaâ†+Â´âŒŠğ•©Ã·size

  pâ†âŸ¨(y+1)â€¿x,yâ€¿(x+1)âŸ©
  câ†{yâ€¿xâ†ğ•©â‹„(y<limit)âˆ§(x<limit)}Â¨p
  zâ†c/p
  âŸ¨z,delta,(size|z)âŸ©
}

Dijkstra2 â† {
  start â† ğ•¨
  end â† ğ•©
  size â† 1+âŠ‘ğ•©
  keys â† â¥Šâ†•sizeâ€¿size

  # Priority node queue
  arr â† âˆâ¥ŠËœâ‰ keys
  i â† keys âŠ‘âˆ˜âŠ<start 
  pQ â† âŸ¨startâ‹ˆ0âŸ©

  distList â‡ 0âŒ¾(iâŠ¸âŠ‘)arr
  done â† 0

  While {ğ•¤â‹„(doneâ‰ 1) âˆ§ (0<â‰ pQ)}â€¿{ğ•¤
    # sort, get smallest value and drop + reassign
    pQ â†© FSortDistList pQ #need to control sorting array size
    smallestNodeâ†âŠ‘âŠ‘pQ
    pQ â†© 1â†“pQ

    {
      smallestNodeâ‰¡end ? doneâ†©1 ; 
      #find all neighboring nodes of this `smallest`
      
      nbNodesâ€¿deltaâ€¿oNbâ†500 FindAdjN2 smallestNode
      smDistâ†âŠ‘(keysâŠ<smallestNode)âŠdistList
      acNDistâ†(9âŠ¸<â—¶âŠ¢â€¿(-âŸœ9))Â¨ delta+oNbâŠ‘input

      candidateDistâ†smDist+acNDist #<--

      nbIndâ†keysâŠnbNodes
      sCâ†candidateDist<nbIndâŠ¸âŠdistList
      nCIndâ†sC/nbInd
      candidateDist /Ëœâ†©sC

      distListâ†©candidateDistâŒ¾(nCIndâŠ¸âŠ)distList

      pQ âˆ¾â†© (nCIndâŠkeys)<âŠ¸âˆ¾Â¨candidateDist
    }
  }
  cost â‡ Â¯1âŠ‘distList
}

#d2 â† 0â€¿0 Dijkstra2 499â€¿499

#â€¢Show d2.cost
