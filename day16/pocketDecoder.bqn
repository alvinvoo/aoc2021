
hexK â† "0123456789ABCDEF"
hexV â† "0000"â€¿"0001"â€¿"0010"â€¿"0011"â€¿"0100"â€¿"0101"â€¿"0110"â€¿"0111"â€¿"1000"â€¿"1001"â€¿"1010"â€¿"1011"â€¿"1100"â€¿"1101"â€¿"1110"â€¿"1111"

##
in â† âˆ¾hexVâŠËœhexKâŠ¸(âŠ‘âˆ˜âŠ)Â¨âŠ‘â€¢FLines "input"
#â€¢Show in â† âˆ¾hexVâŠËœhexKâŠ¸(âŠ‘âˆ˜âŠ)Â¨"9C0141080250320F1802104A08"

Bin2Int â† +Â´(2âŠ¸â‹†â†•âˆ˜â‰ )Ã—(âŒ½-âŸœ'0')
Match â† {ğ•ğ•¨}Â´
DoWhile â† {ğ•¨{ğ•ŠâŸğ”½ğ”¾ğ•©}ğ•©@}Â´

#first, take 3, add version, check type id
#if its literal value, take next 5, if start is 1 (continue)

SClass â† {ğ•Šs:
  p â‡ s  # store a global copy of the input 
  i â‡ 0 # current cursor
  T â† â†‘â‹ˆâ†“
  Take â‡ {nâ€¿râ†ğ•© T pâ‹„pâ†©râ‹„i+â†©ğ•©â‹„n}  # update the input whenever something taken 
}

sin â† SClass in

accumVerâ†0
Step â† {ğ•Šp:
  version â† p.Take 3
  typeid â† p.Take 3
  accumVer +â†© Bin2Int version

  â€¢Show "type"
  â€¢Show typeid

  Match typeidâ€¿{
    "100": 
        câ€¿vâ†@â€¿âŸ¨âŸ©
        DoWhile {ğ•¤â‹„câ‰¡"1"}â€¿{ğ•¤â‹„
          câ†©p.Take 1
          vâˆ¾â†©p.Take 4
        }
        Bin2Int v
        ;
    ğ•©: 
      ltâ†p.Take 1
      rsâ†{
        ltâ‰¡"1"? 
        noSubâ†Bin2Int p.Take 11
        {ğ•Š:Step p}Â¨â†•noSub
        ;
        ltâ‰¡"0"?
        totalLenâ†Bin2Int p.Take 15
        endCurâ†p.i + totalLen
        psâ†âŸ¨âŸ©
        {ğ•Š:psâˆ¾â†©<Step p}â€¢_while_{ğ•Š:p.i<endCur} @
        }
      opâ†Bin2Int ğ•©
      opâ—¶+â€¿Ã—â€¿âŒŠâ€¿âŒˆâ€¿!â€¿>â€¿<â€¿=Â´ rs
  }
}

# part 1
resâ†Step sin
â€¢Show accumVer

#part 2
â€¢Show res

# 1675198555015 - answer
