
hexK â† "0123456789ABCDEF"
hexV â† "0000"â€¿"0001"â€¿"0010"â€¿"0011"â€¿"0100"â€¿"0101"â€¿"0110"â€¿"0111"â€¿"1000"â€¿"1001"â€¿"1010"â€¿"1011"â€¿"1100"â€¿"1101"â€¿"1110"â€¿"1111"

#âˆ¾hexVâŠËœhexKâŠ¸(âŠ‘âˆ˜âŠ)Â¨"D2FE28"
#âˆ¾hexVâŠËœhexKâŠ¸(âŠ‘âˆ˜âŠ)Â¨"8A004A801A8002F478"
#âˆ¾hexVâŠËœhexKâŠ¸(âŠ‘âˆ˜âŠ)Â¨"620080001611562C8802118E34"
#âˆ¾hexVâŠËœhexKâŠ¸(âŠ‘âˆ˜âŠ)Â¨"C0015000016115A2E0802F182340"
#âˆ¾hexVâŠËœhexKâŠ¸(âŠ‘âˆ˜âŠ)Â¨"A0016C880162017C3686B18A3D4780"

##
â€¢Show â€¢FLines "input"
in â† âˆ¾hexVâŠËœhexKâŠ¸(âŠ‘âˆ˜âŠ)Â¨âŠ‘â€¢FLines "input"
litVals â† âŸ¨âŸ©

Bin2Int â† +Â´(2âŠ¸â‹†â†•âˆ˜â‰ )Ã—(âŒ½-âŸœ'0')
Match â† {ğ•ğ•¨}Â´
DoWhile â† {ğ•¨{ğ•ŠâŸğ”½ğ”¾ğ•©}ğ•©@}Â´
T â† â†‘â‹ˆâ†“

#first, take 3, add version, check type id
#if its literal value, take next 5, if start is 1 (continue)
accumVerâ†0
Step â† {ğ•Š:
  headerâ€¿packets â† 6 T in
  versionâ€¿typeid â† 3 T header
  accumVer +â†© Bin2Int version

  Match typeidâ€¿{
    "100": 
        câ€¿dâ€¿pâ€¿nâ†@â€¿@â€¿packetsâ€¿@
        DoWhile {ğ•¤â‹„câ‰¡"1"}â€¿{ğ•¤â‹„
          nâ€¿pâ†©5 T p
          câ€¿dâ†©1 T n
          litVals âˆ¾â†© Bin2Int d
        }
        packets â†© p
        ;
    ğ•©: 
      noSubâ€¿totalLenâ†0â€¿0
      ltâ€¿pâ†1 T packets  
      {ltâ‰¡"1"? noSubâ€¿pâ†©11 T p;totalLenâ€¿pâ†©15 T p}
      packets â†© p
  }
  inâ†©packets
}

Step â€¢_while_ {ğ•¤â‹„ 0â‰¢+Â´'0'-Ëœğ•©} in
â€¢Show accumVer
