in â† â€¢FLines "input"
do â† â€¢ReBQN {replâ‡"strict"}

Tkr â† {1â†‘/"?[],"=ğ•©}â—¶(âŸ¨âŸ©âŠ¸âˆ¾)â€¿"âŸ¨"â€¿"âŸ©"â€¿","Â¨
Tkr1 â† {1â†‘/"?âŸ¨âŸ©,"=ğ•©}â—¶(âŸ¨âŸ©âŠ¸âˆ¾)â€¿"âŸ¨"â€¿"âŸ©"â€¿","Â¨

IntToString â† {ğ•Šint:
  ret â† âŸ¨âŸ©
  {ğ•Š:
    retâˆ¾Ëœâ†©@+48+<10|int
    intâ†©âŒŠintÃ·10
    int>0
  }â€¢_while_âŠ¢ intâ‰¥0
  ret
}
StringToInt â† +Â´{10â‹†âŒ½â†•â‰ ğ•©}Ã—(-âŸœ'0')
Addition â† {"["âˆ¾ğ•¨âˆ¾","âˆ¾ğ•©âˆ¾"]"}
AddTkr â† {âŸ¨"âŸ¨"âŸ©âˆ¾ğ•¨âˆ¾âŸ¨","âŸ©âˆ¾ğ•©âˆ¾âŸ¨"âŸ©"âŸ©}

AddM â† +Â´StringToIntÂ¨

Explode â† {ğ•Šsum:
  #non numbers selectors
  bsâ†"âŸ¨"â€¿"âŸ©"â€¿","â‰¡Â¨Ë˜sumâˆ¾â‰Ëœsum
  #numbers selector
  nsâ†Â¬+Ëbs

  dnumsâ†/ns
  #convert sum to BQN array format in string
  barrâ†Do âˆ¾sum
  {(5â‰¤â‰¡barr)?
    #get 4th level depth arrays selector
    levelsâ†âŸ¨âŸ©
    {sâ†2=â‰ ğ•©â‹„levels âˆ¾â†© s}âš‡Â¯4 barr
    leftmoindâ†âŠ‘/levels
    #get left-most num index - get the pair indices
    lpâ€¿rpâ†leftmoindâ€¿(1+leftmoind)âŠdnums
    leftmoind

    #two new left-right regular values
    nlpâ†{(0>leftmoind-1)?Â¯1;
      llâ†(leftmoind-1)â€¿leftmoind âŠ‘Â¨ <dnums
      vâ†IntToString AddM llâŠsum
      (âŠ‘ll)â€¿v
      }

    nrpâ†{((â‰ dnums)â‰¤leftmoind+2)?Â¯1;
      llâ†(leftmoind+2)â€¿(leftmoind+1) âŠ‘Â¨ <dnums
      vâ†IntToString AddM llâŠsum
      (âŠ‘ll)â€¿v
      }

    #replace range can only do from right to left
    #with starting index + len
    #assume first len = 1 for left and right regular
    #assume first len = 5 for target pair
    {nrpâ‰¢Â¯1?nrâ€¿vâ†nrpâ‹„sumâ†©(nrâ†‘sum)âˆ¾âŸ¨vâŸ©âˆ¾(nr+1)â†“sum;@}
    sumâ†©((lp-1)â†‘sum)âˆ¾âŸ¨"0"âŸ©âˆ¾(5+lp-1)â†“sum
    {nlpâ‰¢Â¯1?nlâ€¿vâ†nlpâ‹„sumâ†©(nlâ†‘sum)âˆ¾âŸ¨vâŸ©âˆ¾(nl+1)â†“sum;@}
    1â€¿sum;
    0â€¿sum}
}

Split â† {ğ•Šin:
  sâ†/2=â‰ Â¨in
  {sâ‰¡âŸ¨âŸ©?in;
    fposâ†âŠ‘s
    tâ†StringToInt fposâŠ‘in
    splittedâ†{aâ€¿bâ†(IntToStringÂ¨ âŒŠâ‰âŒˆ)ğ•©Ã·2â‹„âŸ¨"âŸ¨"âŸ©âˆ¾âŸ¨aâŸ©âˆ¾âŸ¨","âŸ©âˆ¾âŸ¨bâŸ©âˆ¾âŸ¨"âŸ©"âŸ©}t
    (fposâ†‘in)âˆ¾splittedâˆ¾(fpos+1)â†“in}
}

Step â† {exbâ€¿spbğ•Ša:
  {exb?
    #explode
    {ğ•Š:oâ€¿bâ†Explode aâ‹„aâ†©bâ‹„o}â€¢_while_âŠ¢ 1â‹„a
    ;
    spb?
      #split
      Split a;
      a}
}

Fcâ†{5â‰¤â‰¡Doâˆ¾ğ•©}âˆ¾{Ã—â‰ /2=â‰ Â¨ğ•©}

input â† TkrÂ¨in

#step until 5>â‰¡ and /2=â‰ Â¨ is âŸ¨âŸ©
Add1 â† {
  aâ†ğ•¨ AddTkr ğ•©
  selâ†âŸ¨âŸ©
  {ğ•Š: aâ†©sel Step a}â€¢_while_{selâ†©Fcğ•©â‹„âˆ¨Â´sel} a
}

# part 1 - answer 4176
#â€¢Show finArrâ‡Doâˆ¾Add1ËœÂ´ âŒ½input
#
Magâ‡{2â‰¡â‰ ğ•©?aâ€¿bâ†ğ•©â‹„(3Ã—a)+(2Ã—b);ğ•©}
#â€¢Show Mag MagÂ¨ Magâš‡Â¯2 Magâš‡Â¯3 finArr

FMag â† {Mag MagÂ¨ Magâš‡Â¯2 Magâš‡Â¯3 ğ•©}
fâ†input {lğ•Šr: {lâ‰¡r?0;FMagâˆ˜Doâˆ¾l Add1 r}}âŒœ input
â€¢Show âŒˆÂ´â¥Šf
# first guess 4709 - too high (need sum of two DIFFERENT numbers)
# answer - 4633


