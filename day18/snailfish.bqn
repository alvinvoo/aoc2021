in â† â€¢FLines "inputEx1"
do â† â€¢ReBQN {replâ‡"strict"}

Tkr â† {1â†‘/"?[],"=ğ•©}â—¶(âŸ¨âŸ©âŠ¸âˆ¾)â€¿"âŸ¨"â€¿"âŸ©"â€¿","Â¨
Tkr1 â† {1â†‘/"?âŸ¨âŸ©,"=ğ•©}â—¶(âŸ¨âŸ©âŠ¸âˆ¾)â€¿"âŸ¨"â€¿"âŸ©"â€¿","Â¨

IntToString â‡ {ğ•Šint:
  ret â† âŸ¨âŸ©
  {ğ•Š:
    retâˆ¾Ëœâ†©@+48+<10|int
    intâ†©âŒŠintÃ·10
    int>0
  }â€¢_while_âŠ¢ int>0
  ret
}
StringToInt â† +Â´{10â‹†âŒ½â†•â‰ ğ•©}Ã—(-âŸœ'0')
Addition â† {"["âˆ¾ğ•¨âˆ¾","âˆ¾ğ•©âˆ¾"]"}
AddTkr â† {âŸ¨"âŸ¨"âŸ©âˆ¾ğ•¨âˆ¾âŸ¨","âŸ©âˆ¾ğ•©âˆ¾âŸ¨"âŸ©"âŸ©}

AddM â† +Â´StringToIntÂ¨

Explode â† {ğ•Šsum:
  #non numbers selectors
  bsâ†"âŸ¨"â€¿"âŸ©"â€¿","â‰¡Â¨Ë˜sumâˆ¾â‰Ëœsum
  #numbers selector
  nsâ†Â¬+Ëbs

  dnumsâ†/ns
  #convert sum to BQN array format in string
  barrâ†Do âˆ¾sum
  {(5â‰¤â‰¡barr)?
    #get 4th level depth arrays selector
    levelsâ†âŸ¨âŸ©
    {sâ†2=â‰ ğ•©â‹„levels âˆ¾â†© s}âš‡Â¯4 barr
    leftmoindâ†âŠ‘/levels
    #get left-most num index - get the pair indices
    lpâ€¿rpâ†leftmoindâ€¿(1+leftmoind)âŠdnums
    leftmoind

    #two new left-right regular values
    nlpâ†{(0>leftmoind-1)?Â¯1;
      llâ†(leftmoind-1)â€¿leftmoind âŠ‘Â¨ <dnums
      vâ†IntToString AddM llâŠsum
      #cannot split first
      #vrâ†{v>9?{aâ€¿bâ†(+âŸœ(48+@) âŒŠâ‰âŒˆ)ğ•©â‹„"["âˆ¾aâˆ¾","âˆ¾bâˆ¾"]"}vÃ·2;âŸ¨v+48+@âŸ©}
      (âŠ‘ll)â€¿v
      }

    nrpâ†{((â‰ dnums)â‰¤leftmoind+2)?Â¯1;
      llâ†(leftmoind+2)â€¿(leftmoind+1) âŠ‘Â¨ <dnums
      vâ†IntToString AddM llâŠsum
      #vrâ†{v>9?{aâ€¿bâ†(+âŸœ(48+@) âŒŠâ‰âŒˆ)ğ•©â‹„"["âˆ¾aâˆ¾","âˆ¾bâˆ¾"]"}vÃ·2;âŸ¨v+48+@âŸ©}
      (âŠ‘ll)â€¿v
      }

    #replace range can only do from right to left
    #with starting index + len
    #assume first len = 1 for left and right regular
    #assume first len = 5 for target pair
    {nrpâ‰¢Â¯1?nrâ€¿vâ†nrpâ‹„sumâ†©(nrâ†‘sum)âˆ¾âŸ¨vâŸ©âˆ¾(nr+1)â†“sum;@}
    sumâ†©((lp-1)â†‘sum)âˆ¾âŸ¨"0"âŸ©âˆ¾(5+lp-1)â†“sum
    {nlpâ‰¢Â¯1?nlâ€¿vâ†nlpâ‹„sumâ†©(nlâ†‘sum)âˆ¾âŸ¨vâŸ©âˆ¾(nl+1)â†“sum;@}
    1â€¿sum;
    0â€¿sum}
}

Split â† {ğ•Šin:
  sâ†/2=â‰ Â¨in
  {sâ‰¡âŸ¨âŸ©?in;
    fposâ†âŠ‘s
    tâ†StringToInt fposâŠ‘in
    splittedâ†{aâ€¿bâ†(IntToStringÂ¨ âŒŠâ‰âŒˆ)ğ•©Ã·2â‹„âŸ¨"âŸ¨"âŸ©âˆ¾âŸ¨aâŸ©âˆ¾âŸ¨","âŸ©âˆ¾âŸ¨bâŸ©âˆ¾âŸ¨"âŸ©"âŸ©}t
    (fposâ†‘in)âˆ¾splittedâˆ¾(fpos+1)â†“in}
}

#aâ†"[3,[2,[1,[7,3]]]]" Addition "[6,[5,[4,[3,2]]]]"
#aâ†"[[[[4,3],4],4],[7,[[8,4],9]]]" AddTkrâ—‹Tkr "[1,1]"
#aâ†"[[[0,[4,5]],[0,0]],[[[4,5],[2,6]],[9,5]]]" AddTkrâ—‹Tkr "[7,[[[3,7],[4,3]],[[6,3],[8,8]]]]"
#
Step â† {ğ•Ša:
  {(5=â‰¡Do âˆ¾a)?
    #explode
    {ğ•Š:oâ€¿bâ†Explode aâ‹„aâ†©bâ‹„o}â€¢_while_âŠ¢ 1â‹„a
    ;
    (Ã—â‰ /2=â‰ Â¨a)?
      #split
      Split a;
      a}
}

#step until 5>â‰¡ and /2=â‰ Â¨ is âŸ¨âŸ©
aâ†"[[[0,[4,5]],[0,0]],[[[4,5],[2,6]],[9,5]]]" AddTkrâ—‹Tkr "[7,[[[3,7],[4,3]],[[6,3],[8,8]]]]"
â€¢Show StepâŸ15 a








