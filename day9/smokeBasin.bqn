input â† â€¢file.Lines "input"

# part 1
input â†© '0' -Ëœ >input

#lr1 â† (9Â»Ë˜input) - input
#lr2 â† (9Â«Ë˜input) - input
#â€¢Show lr â† (lr1 > 0) âˆ§ (lr2 > 0)

# refactored
lr â† ((0âŠ¸<9âŠ¸Â»Ë˜-âŠ¢)âˆ§(0âŠ¸<9âŠ¸Â«Ë˜-âŠ¢)) input

#ud1â† â‰(9Â»Ë˜â‰input) - â‰input
#ud2â† â‰(9Â«Ë˜â‰input) - â‰input
#ud â† (ud1 > 0) âˆ§ (ud2 > 0)

# refactored
ud â† ((0âŠ¸<9âŠ¸Â»Ë˜-âŠ¢)âˆ§(0âŠ¸<9âŠ¸Â«Ë˜-âŠ¢))âŒ¾â‰ input

lowPointsMask â† lr âˆ§ ud

#allLowPoints â† (<Ë˜(lr âˆ§ ud)) /Â¨ <Ë˜input

# refactored
allLowPoints â† âˆ¾lowPointsMask (/Â¨â—‹<Ë˜) input
+Â´1+((0âŠ¸<â‰ )Â¨/âŠ¢) allLowPoints

# part 2
coordsMask â† â†•â‰¢lowPointsMask

# x-y coord of all lowest points
â€¢Show lowPointCoords â† âˆ¾lowPointsMask (/Â¨â—‹<Ë˜) coordsMask

#withBorders â† {Â¯1âˆ¾Ë˜ğ•©âˆ¾Ë˜Â¯1}âŒ¾â‰ Â¯1âˆ¾Ë˜ (Â¯1Ã—input=9) âˆ¾Ë˜Â¯1
â€¢Show hrâ€¿wr â† 1-Ëœâ‰¢input
â€¢Show blockedCoords â† âˆ¾(<Ë˜input=9)/Â¨(<Ë˜â†•â‰¢input)

FCount â† {
  # base conditions: if current cell x or y < 0 | x or y > range 
  # or coord already blocked/traversed
  # else, add 1 to counter
  # pass all up, down, left, right coords and counter recursively 
    yâ€¿x â† ğ•© 
   {(âˆ¨Â´yâ€¿x < 0)âˆ¨(y > hr)âˆ¨(x > wr)âˆ¨(âŠ‘âŸ¨yâ€¿xâŸ©âˆŠblockedCoords) ? 0 ; 
    blockedCoords âˆ¾â†© âŸ¨yâ€¿xâŸ© â‹„ 
    1 + (FCount âŸ¨y,x-1âŸ©) + (FCount âŸ¨y,x+1âŸ©) + (FCount âŸ¨y-1,xâŸ©) + (FCount âŸ¨y+1,xâŸ©)}
}

Ã—Â´3â†‘âˆ¨FCountÂ¨lowPointCoords


